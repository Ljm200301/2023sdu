# 实现方式
## AES
AES（Advanced Encryption Standard）是一种对称加密算法，它使用相同的密钥对数据进行加密和解密。AES128 使用 128 位密钥对数据进行加密和解密，它的加密过程可以用以下公式表示：
### 分组
将明文数据按照128位一组进行分组，可以将每个分组表示为一个 $4 \times 4$ 的矩阵 $S$，其中 $S_{i,j}$ 表示矩阵中第 $i$ 行第 $j$ 列的元素。
### 密钥扩展
将 128 位密钥扩展为 176 个字节的轮密钥，每个轮密钥的长度为 16 字节。扩展密钥的过程包括以下步骤：  
初始轮密钥：将 128 位密钥按照字节拆分为 16 个字节，作为初始轮密钥。  
轮密钥扩展：根据初始轮密钥生成其他的轮密钥，直到得到 10 个轮密钥，每个轮密钥占用 16 个字节。  
### 轮函数  
轮函数是 AES 加密算法中的核心部分，它包含四个步骤：SubBytes、ShiftRows、MixColumns 和 AddRoundKey。  
SubBytes：使用一个 S 盒将每个字节替换为另一个字节。  
ShiftRows：对每个分组进行行移位，第 $i$ 行移位 $i-1$ 个字节。  
MixColumns：对每个分组进行列混淆，使用固定的矩阵乘法计算。  
AddRoundKey：每个分组与对应的轮密钥进行按位异或运算。  
### 加密
加密过程是将明文数据按照分组进行加密，并依次执行 10 个轮函数，最后得到密文数据。  
### 解密
解密过程与加密过程类似，只是轮密钥的顺序与加密过程相反。解密过程中需要执行 10 个轮函数，每个轮函数使用对应的轮密钥进行解密操作。  
## SM4
### 轮函数
SM4算法的轮函数包括以下四个部分：  

线性变换$L$：将输入的32位数据进行一次线性变换，以增加加密的随机性。线性变换$L$采用了一种称为布尔函数的数学模型，并通过移位和异或运算实现

$$C=L(B)=B\oplus(B\gg2)\oplus(B\gg10)\oplus(B\gg18)\oplus(B\gg24)$$

其中，$\gg$表示右移操作，$\oplus$表示异或操作。

非线性变换$S$：将$L$的输出作为输入，进行一次非线性变换，以增加加密的复杂性。非线性变换$S$由四个并行的S盒构成，每个S盒输入4位，输出4位。S盒的具体实现是通过查表的方式实现的。

设输入为$A=(a_0,a_1,a_2,a_3)\in(F_2^8)^4$，则输出为$B=(S(a_0),S(a_1),S(a_2),S(a_3))$。

合成置换$T$：将$S$的输出作为输入，进行一次可逆的置换操作。合成置换$T$由线性变换$L$和非线性变换$S$组成，即$T=L\circ S$。

反序变换$R$：将$T$的输出作为输入，进行一次反序变换，以增加加密的随机性。反序变换$R$将32位数据分为4组，每组8位，然后将这4组数据进行反序操作，即将最高位与最低位交换，次高位与次低位交换，以此类推。

设输入为$(X_{32},X_{33},X_{34},X_{35})$，则输出为$(Y_0,Y_1,Y_2,Y_3)=R(X_{32},X_{33},X_{34},X_{35})=(X_{35},X_{34},X_{33},X_{32})$。
### 密钥生成
SM4算法将128比特的加密密钥$K$扩展成32个32比特的轮密钥$rk_i (i=0,...,31)$，具体过程如下：

计算系统参数$FK=(0xA3B1BAC6, 0x56AA3350, 0x677D9197, 0xB27022DC)$。

计算中间值$k=(k_0,k_1,k_2,k_3)=K\oplus FK$。

对于每个$i\in{0,1,\dots,31}$，计算轮密钥$rk_i$，具体计算方式如下：

(1) 计算中间值$B=k_{i+1}\oplus k_{i+2}\oplus k_{i+3}\oplus CK_i$，其中$CK_i=(CK_{i,0},CK_{i,1},CK_{i,2},CK_{i,3})$，$CK_{i,j}=(4i+j)\times7\mod 256$。

(2) 计算线性变换$L^{\prime}(B)=B\oplus(B\gg13)\oplus(B\gg23)$。

(3) 计算非线性变换$S(B)=(S(B_0),S(B_1),S(B_2),S(B_3))$，其中$B=(B_0,B_1,B_2,B_3)$，$S$为SM4算法中的S盒。

(4) 计算轮密钥$rk_i=k_i\oplus L^{\prime}(S(k_{i+1}\oplus k_{i+2}\oplus k_{i+3}\oplus CK_i))$。

最终得到的$rk_i$序列就是SM4算法的32个轮密钥，用于加密和解密过程中的轮函数计算。
# 实现效果

<div align="center">
  <img src="https://github.com/Ljm200301/ljm/blob/main/pictures/AES.png">
</div>

<div align="center">
  <img src="https://github.com/Ljm200301/ljm/blob/main/pictures/SM4.png">
</div>
